<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord - Gestion Aéroport</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="terminal">
    <div id="output"></div>
    
    <div id="menu-container">
        <h3 id="menu-title"></h3>
        <div id="menu-options"></div>
        <br>
        <button id="logoutButton">Logout</button>
    </div>
</div>

<script>
    const outputDiv = document.getElementById('output');
    const menuContainer = document.getElementById('menu-container');
    const logoutButton = document.getElementById('logoutButton');
    const menuTitle = document.getElementById('menu-title');
    const menuOptions = document.getElementById('menu-options');

    let loggedInUser = null;

    // Check for logged in user on page load
    document.addEventListener('DOMContentLoaded', () => {
        const userJson = sessionStorage.getItem('loggedInUser');
        if (!userJson) {
            window.location.href = 'login.html';
            return;
        }
        loggedInUser = JSON.parse(userJson);
        showMenu();
    });

    function showMenu() {
        menuTitle.innerText = `Welcome, ${loggedInUser.name} (level: ${loggedInUser.type})`;

        let optionsHtml = '';
        if (loggedInUser.type === 'gestionnaire') {
            optionsHtml += '<p>Options de création :</p>';
            optionsHtml += '<button data-action="create-gestionnaire">Créer un compte Gestionnaire</button><br><br>';
            optionsHtml += '<button data-action="create-agent">Créer un compte Agent</button><br><br>';
            optionsHtml += '<button data-action="create-pilote">Créer un compte Pilote</button>';
        } else if (loggedInUser.type === 'agent') {
            optionsHtml += '<p>Options de création :</p>';
            optionsHtml += '<button data-action="create-pilote">Créer un compte Pilote</button>';
        } else {
            optionsHtml += '<p>Aucune action de création de compte disponible.</p>';
        }
        menuOptions.innerHTML = optionsHtml;
    }

    logoutButton.addEventListener('click', () => {
        sessionStorage.removeItem('loggedInUser');
        window.location.href = 'login.html';
    });

    menuOptions.addEventListener('click', function(event) {
        if (event.target.tagName === 'BUTTON') {
            const action = event.target.getAttribute('data-action');
            if (action && action.startsWith('create-')) {
                const userType = action.split('-')[1];
                window.location.href = `create_user.html?type=${userType}`;
            }
        }
    });
</script>

</body>
</html>
